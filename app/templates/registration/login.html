<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferremas - Tienda Online de Herramientas de Construcci칩n</title>
    <link rel="stylesheet" href="{% static 'style.css' %}">
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6LeUu4sqAAAAAMIVZdth4Kr490MsZZhTujSjU6mU"></script>
</head>
<body>
    <div id="header">
        <h1 class="title">Ferremas</h1>
    </div>

    <nav>
        <a class="nav-link" href="{% url 'index' %}">Inicio</a>
        <a class="nav-link" href="{% url 'nosotros' %}">Nosotros</a>
        <a class="nav-link" href="{% url 'productos' %}">Productos</a>
        <a class="nav-link" href="{% url 'login' %}">Iniciar Sesi칩n</a>
    </nav>

    <h2>Login</h2>

    <!-- Formulario de Login -->
    <form id="login-form" method="post" action="{% url 'login_view' %}">
        {% csrf_token %}
        <label for="username">Usuario:</label><br>
        <input type="text" id="username" name="username" placeholder="Ingresa tu usuario" required><br>

        <label for="password">Contrase침a:</label><br>
        <input type="password" id="password" name="password" placeholder="Ingresa tu contrase침a" required><br>

        <!-- Campo oculto para el token reCAPTCHA -->
        <input type="hidden" name="recaptcha-token" id="recaptcha-token">

        <button type="button" onclick="onSubmit()">Login</button>
    </form>

    <!-- Mensaje de error (si lo hay) -->
    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}

    <!-- Script para manejar reCAPTCHA -->
    <script>
        function onSubmit() {
            grecaptcha.enterprise.ready(async () => {
                const token = await grecaptcha.enterprise.execute('6LeUu4sqAAAAAMIVZdth4Kr490MsZZhTujSjU6mU', { action: 'LOGIN' });
                document.getElementById('recaptcha-token').value = token;
                document.getElementById('login-form').submit();
            });
        }
    </script>
</body>
</html>
